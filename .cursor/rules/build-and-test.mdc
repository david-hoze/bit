---
description: Build and test practices for the bit project
alwaysApply: true
---

# Build and Test Practices

## Building

Always use `cabal` for building this Haskell project:

```bash
# Build the project
cabal build bit

# Get the path to the built binary
cabal list-bin bit
```

## Running Tests

### CLI Tests

CLI tests use **shelltest** (Format 3 `.test` files in `test/cli/`).

**Run all CLI tests:**
```bash
cabal test cli
```

**Run a specific test file:**
```bash
# Ensure bit is on PATH, then run shelltest directly
shelltest test/cli/init-config.test
```

**Get detailed output:**
```bash
# Use --debug flag for verbose output showing full commands and diffs
shelltest test/cli/init-config.test --debug
```

### Unit Tests

```bash
# Run device-prompt tests
cabal test device-prompt

# Run pipeline tests
cabal test pipeline

# Run merge tests
cabal test merge
```

## Test File Locations

- `test/cli/*.test` - CLI integration tests (shelltest Format 3)
- `test/DevicePromptTests.hs` - Device prompt unit tests
- `test/PipelineSpec.hs` - Pipeline unit tests
- `test/MergeSpec.hs` - Merge unit tests
- `test/RunCliTests.hs` - CLI test runner

## Important Notes

- Always run tests from the repository root so paths resolve correctly
- CLI tests create temporary directories in `test/cli/work*`
- Use `--debug` flag with shelltest to see detailed test execution when debugging failures
